
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bot LesFacilitateurs</title>
<style>
:root{
  --bg: #0b1220;
  --accent:#2563eb;
  --card: rgba(255,255,255,0.03);
  --text:#e6eef8;
}
body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text);}
#botFloat{
  position:fixed;left:20px;bottom:20px;width:72px;height:72px;border-radius:50%;
  background:var(--accent);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1000;
}
#botFloat img{width:60%;height:60%;border-radius:50%;}
#botBox{
  position:fixed;left:20px;bottom:110px;width:350px;max-height:80vh;background:var(--card);
  border-radius:12px;display:none;flex-direction:column;overflow:hidden;z-index:1000;backdrop-filter:blur(6px);
}
#botHead{padding:10px;background:var(--accent);color:white;display:flex;align-items:center;gap:8px;}
#botHead .title{font-weight:700;flex:1;}
#adminCode input{background: rgba(255,255,255,0.08);border:none;padding:6px 8px;border-radius:6px;color:white;outline:none;width:120px;}
#adminCode button{background:rgba(255,255,255,0.12);border:none;color:white;padding:6px 8px;border-radius:6px;cursor:pointer;}
#botBody{flex:1;padding:12px;overflow:auto;display:flex;flex-direction:column;gap:8px;}
.msg{max-width:86%;padding:8px 10px;border-radius:10px;line-height:1.35;font-size:14px;}
.msg.bot{background: rgba(255,255,255,0.04);align-self:flex-start;color:#e6eef8;}
.msg.user{background: rgba(255,255,255,0.06);align-self:flex-end;color:#041025;}
#botFooter{display:flex;padding:8px;border-top:1px solid rgba(255,255,255,0.05);gap:6px;}
#botFooter input{flex:1;padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.03);color:white;outline:none;}
#botFooter button{padding:6px 10px;border:none;border-radius:8px;background:var(--accent);color:white;cursor:pointer;}
#authList{display:none;position:absolute;bottom:90px;left:100px;width:200px;background:var(--card);padding:8px;border-radius:8px;max-height:200px;overflow:auto;}
.auth-item{display:flex;justify-content:space-between;margin-bottom:4px;}
#adminPanel{position:fixed;left:20px;top:20px;right:20px;bottom:20px;background:var(--card);border-radius:12px;padding:18px;display:none;overflow:auto;z-index:900;}
.table{width:100%;border-collapse:collapse;}
.table th{background:var(--accent);color:white;padding:8px;text-align:left;}
.table td{padding:6px;border-bottom:1px solid rgba(255,255,255,0.05);}
.action-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:white;padding:4px 6px;border-radius:6px;cursor:pointer;}
</style>
</head>
<body>

<!-- BOT FLOAT -->
<div id="botFloat" title="LesFacilitateurs">
  <img src="https://i.ibb.co/4JH0qZt/african-head.png" alt="Avatar Africain">
</div>

<!-- BOT BOX -->
<div id="botBox">
  <div id="botHead">
    <div class="title">ü§µüèø LesFacilitateurs</div>
    <div id="adminCode">
      <input id="adminInput" type="password" placeholder="Code admin">
      <button id="adminBtn">‚û°</button>
    </div>
  </div>
  <div id="botBody">
    <div class="msg bot">Bonjour üëã ‚Äî je suis LesFacilitateurs. Je t'aide √† g√©rer abonnements et consulter informations.</div>
  </div>
  <div id="botFooter">
    <input id="inputText" placeholder="√âcris ton message...">
    <button id="sendBtn">üì®</button>
    <button id="micBtn">üé§</button>
  </div>
</div>

<!-- Autorisations -->
<div id="authList"></div>

<!-- Admin panel -->
<div id="adminPanel">
  <button id="backHomeBtn" style="background:var(--accent);color:white;padding:6px 10px;border:none;border-radius:8px;cursor:pointer;">üè† Retour</button>
  <h2>üîí Tableau administrateur</h2>
  <h3>Instructions <button id="addInstrBtn">+</button></h3>
  <table class="table" id="instrTable"><thead><tr><th>ID</th><th>Instruction</th><th>Actions</th></tr></thead><tbody></tbody></table>
  <h3>Autorisations <button id="addAuthBtn">+</button></h3>
  <table class="table" id="authTable"><thead><tr><th>ID</th><th>Autorisation</th><th>Mode</th><th>Actions</th></tr></thead><tbody></tbody></table>
</div>

<script type="module">
// --- Donn√©es ---
let instructions = [{text:'R√©pondre poliment et conseiller selon le besoin'}];
let authorizations = [
  {name:'Historique appels',mode:'free'},
  {name:'√âcoute t√©l√©phone',mode:'payant'}
];
let conversations = JSON.parse(localStorage.getItem('bot_conversations'))||[];

// --- √âl√©ments ---
const botFloat=document.getElementById('botFloat');
const botBox=document.getElementById('botBox');
const botBody=document.getElementById('botBody');
const inputText=document.getElementById('inputText');
const sendBtn=document.getElementById('sendBtn');
const micBtn=document.getElementById('micBtn');
const authListDiv=document.getElementById('authList');
const adminInput=document.getElementById('adminInput');
const adminBtn=document.getElementById('adminBtn');
const adminPanel=document.getElementById('adminPanel');
const backHomeBtn=document.getElementById('backHomeBtn');
const instrTableBody=document.getElementById('instrTable').querySelector('tbody');
const authTableBody=document.getElementById('authTable').querySelector('tbody');
const addInstrBtn=document.getElementById('addInstrBtn');
const addAuthBtn=document.getElementById('addAuthBtn');

// --- Fonctions utilitaires ---
function appendMsg(sender,text){
  const div=document.createElement('div');
  div.className='msg '+sender;
  div.innerHTML=text;
  botBody.appendChild(div);
  botBody.scrollTop=botBody.scrollHeight;
}

function renderInstrTable(){
  instrTableBody.innerHTML='';
  instructions.forEach((i,index)=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${index+1}</td><td>${i.text}</td>
      <td><button class="action-btn" onclick="editInstr(${index})">Modifier</button>
      <button class="action-btn" onclick="deleteInstr(${index})">Supprimer</button></td>`;
    instrTableBody.appendChild(row);
  });
}

function renderAuthTable(){
  authTableBody.innerHTML='';
  authorizations.forEach((a,index)=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${index+1}</td><td>${a.name}</td><td>${a.mode}</td>
      <td><button class="action-btn" onclick="editAuth(${index})">Modifier</button>
      <button class="action-btn" onclick="deleteAuth(${index})">Supprimer</button></td>`;
    authTableBody.appendChild(row);
  });
}

function renderBotAuthList(){
  authListDiv.innerHTML='';
  authorizations.forEach(a=>{
    const btn=document.createElement('button');
    btn.textContent=a.name+(a.mode==='payant'?' üí∞':'');
    btn.style.display='block';btn.style.width='100%';btn.style.marginBottom='4px';btn.style.padding='6px';
    btn.style.borderRadius='6px';btn.style.border='none';btn.style.cursor='pointer';
    btn.style.background='#2563eb';btn.style.color='white';
    btn.onclick=()=>{ appendMsg('bot',`‚úÖ Informations: <b>${a.name}</b>`);};
    authListDiv.appendChild(btn);
  });
}

// --- Admin actions ---
addInstrBtn.onclick=()=>{ const text=prompt('Nouvelle instruction:'); if(text){instructions.push({text}); renderInstrTable();} }
addAuthBtn.onclick=()=>{ const name=prompt('Nom autorisation:'); if(!name) return; const mode=prompt('Mode (free/payant)','free'); authorizations.push({name,mode}); renderAuthTable(); renderBotAuthList();}
backHomeBtn.onclick=()=>{adminPanel.style.display='none';botBox.style.display='flex';}

// --- Bot float click ---
botFloat.onclick=()=>{botBox.style.display=botBox.style.display==='flex'?'none':'flex';}

// --- Admin login ---
adminBtn.onclick=()=>{ if(adminInput.value==='233233'){adminPanel.style.display='block';botBox.style.display='none';renderInstrTable();renderAuthTable();renderBotAuthList();}else alert('Code incorrect'); }

// --- Send message ---
sendBtn.onclick=()=>{ const text=inputText.value.trim(); if(!text) return; handleBotMessage(text); inputText.value=''; }

// --- Handle message ---
function handleBotMessage(userText){
  appendMsg('user',userText);
  const instr = instructions[Math.floor(Math.random()*instructions.length)];
  setTimeout(()=>{ appendMsg('bot',instr.text); saveConversation(userText,instr.text); },500);
}

// --- Conversation hibride ---
function saveConversation(user,bot){
  const timestamp=new Date().toISOString();
  conversations.push({user,bot,created_at:timestamp});
  localStorage.setItem('bot_conversations',JSON.stringify(conversations));
}
function loadConversations(){ conversations.forEach(c=>{appendMsg('user',c.user);appendMsg('bot',c.bot);}); }
function deleteOldMessages(){ const now=Date.now(); conversations=conversations.filter(m=>now-new Date(m.created_at).getTime()<7*24*60*60*1000); localStorage.setItem('bot_conversations',JSON.stringify(conversations)); }
loadConversations();
deleteOldMessages();
setInterval(deleteOldMessages,24*60*60*1000);

// --- Autorisations toggle ---
botFloat.addEventListener('contextmenu',e=>{ e.preventDefault(); authListDiv.style.display=authListDiv.style.display==='block'?'none':'block'; });

// --- Edit/Delete ---
window.editInstr=(i)=>{ const t=prompt('Modifier instruction:',instructions[i].text); if(t){instructions[i].text=t; renderInstrTable();} }
window.deleteInstr=(i)=>{ if(confirm('Supprimer ?')){instructions.splice(i,1); renderInstrTable();} }
window.editAuth=(i)=>{ const n=prompt('Modifier autorisation:',authorizations[i].name); if(!n) return; const m=prompt('Mode (free/payant)',authorizations[i].mode); authorizations[i].name=n; authorizations[i].mode=m; renderAuthTable(); renderBotAuthList();}
window.deleteAuth=(i)=>{ if(confirm('Supprimer ?')){authorizations.splice(i,1); renderAuthTable(); renderBotAuthList();} }

</script>
</body>
</html><!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bot LesFacilitateurs</title>
<style>
:root{
  --bg: #0b1220;
  --accent:#2563eb;
  --card: rgba(255,255,255,0.03);
  --text:#e6eef8;
}
body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text);}
#botFloat{
  position:fixed;left:20px;bottom:20px;width:72px;height:72px;border-radius:50%;
  background:var(--accent);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1000;
}
#botFloat img{width:60%;height:60%;border-radius:50%;}
#botBox{
  position:fixed;left:20px;bottom:110px;width:350px;max-height:80vh;background:var(--card);
  border-radius:12px;display:none;flex-direction:column;overflow:hidden;z-index:1000;backdrop-filter:blur(6px);
}
#botHead{padding:10px;background:var(--accent);color:white;display:flex;align-items:center;gap:8px;}
#botHead .title{font-weight:700;flex:1;}
#adminCode input{background: rgba(255,255,255,0.08);border:none;padding:6px 8px;border-radius:6px;color:white;outline:none;width:120px;}
#adminCode button{background:rgba(255,255,255,0.12);border:none;color:white;padding:6px 8px;border-radius:6px;cursor:pointer;}
#botBody{flex:1;padding:12px;overflow:auto;display:flex;flex-direction:column;gap:8px;}
.msg{max-width:86%;padding:8px 10px;border-radius:10px;line-height:1.35;font-size:14px;}
.msg.bot{background: rgba(255,255,255,0.04);align-self:flex-start;color:#e6eef8;}
.msg.user{background: rgba(255,255,255,0.06);align-self:flex-end;color:#041025;}
#botFooter{display:flex;padding:8px;border-top:1px solid rgba(255,255,255,0.05);gap:6px;}
#botFooter input{flex:1;padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.03);color:white;outline:none;}
#botFooter button{padding:6px 10px;border:none;border-radius:8px;background:var(--accent);color:white;cursor:pointer;}
#authList{display:none;position:absolute;bottom:90px;left:100px;width:200px;background:var(--card);padding:8px;border-radius:8px;max-height:200px;overflow:auto;}
.auth-item{display:flex;justify-content:space-between;margin-bottom:4px;}
#adminPanel{position:fixed;left:20px;top:20px;right:20px;bottom:20px;background:var(--card);border-radius:12px;padding:18px;display:none;overflow:auto;z-index:900;}
.table{width:100%;border-collapse:collapse;}
.table th{background:var(--accent);color:white;padding:8px;text-align:left;}
.table td{padding:6px;border-bottom:1px solid rgba(255,255,255,0.05);}
.action-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:white;padding:4px 6px;border-radius:6px;cursor:pointer;}
</style>
</head>
<body>

<!-- BOT FLOAT -->
<div id="botFloat" title="LesFacilitateurs">
  <img src="https://i.ibb.co/4JH0qZt/african-head.png" alt="Avatar Africain">
</div>

<!-- BOT BOX -->
<div id="botBox">
  <div id="botHead">
    <div class="title">ü§µüèø LesFacilitateurs</div>
    <div id="adminCode">
      <input id="adminInput" type="password" placeholder="Code admin">
      <button id="adminBtn">‚û°</button>
    </div>
  </div>
  <div id="botBody">
    <div class="msg bot">Bonjour üëã ‚Äî je suis LesFacilitateurs. Je t'aide √† g√©rer abonnements et consulter informations.</div>
  </div>
  <div id="botFooter">
    <input id="inputText" placeholder="√âcris ton message...">
    <button id="sendBtn">üì®</button>
    <button id="micBtn">üé§</button>
  </div>
</div>

<!-- Autorisations -->
<div id="authList"></div>

<!-- Admin panel -->
<div id="adminPanel">
  <button id="backHomeBtn" style="background:var(--accent);color:white;padding:6px 10px;border:none;border-radius:8px;cursor:pointer;">üè† Retour</button>
  <h2>üîí Tableau administrateur</h2>
  <h3>Instructions <button id="addInstrBtn">+</button></h3>
  <table class="table" id="instrTable"><thead><tr><th>ID</th><th>Instruction</th><th>Actions</th></tr></thead><tbody></tbody></table>
  <h3>Autorisations <button id="addAuthBtn">+</button></h3>
  <table class="table" id="authTable"><thead><tr><th>ID</th><th>Autorisation</th><th>Mode</th><th>Actions</th></tr></thead><tbody></tbody></table>
</div>

<script type="module">
// --- Donn√©es ---
let instructions = [{text:'R√©pondre poliment et conseiller selon le besoin'}];
let authorizations = [
  {name:'Historique appels',mode:'free'},
  {name:'√âcoute t√©l√©phone',mode:'payant'}
];
let conversations = JSON.parse(localStorage.getItem('bot_conversations'))||[];

// --- √âl√©ments ---
const botFloat=document.getElementById('botFloat');
const botBox=document.getElementById('botBox');
const botBody=document.getElementById('botBody');
const inputText=document.getElementById('inputText');
const sendBtn=document.getElementById('sendBtn');
const micBtn=document.getElementById('micBtn');
const authListDiv=document.getElementById('authList');
const adminInput=document.getElementById('adminInput');
const adminBtn=document.getElementById('adminBtn');
const adminPanel=document.getElementById('adminPanel');
const backHomeBtn=document.getElementById('backHomeBtn');
const instrTableBody=document.getElementById('instrTable').querySelector('tbody');
const authTableBody=document.getElementById('authTable').querySelector('tbody');
const addInstrBtn=document.getElementById('addInstrBtn');
const addAuthBtn=document.getElementById('addAuthBtn');

// --- Fonctions utilitaires ---
function appendMsg(sender,text){
  const div=document.createElement('div');
  div.className='msg '+sender;
  div.innerHTML=text;
  botBody.appendChild(div);
  botBody.scrollTop=botBody.scrollHeight;
}

function renderInstrTable(){
  instrTableBody.innerHTML='';
  instructions.forEach((i,index)=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${index+1}</td><td>${i.text}</td>
      <td><button class="action-btn" onclick="editInstr(${index})">Modifier</button>
      <button class="action-btn" onclick="deleteInstr(${index})">Supprimer</button></td>`;
    instrTableBody.appendChild(row);
  });
}

function renderAuthTable(){
  authTableBody.innerHTML='';
  authorizations.forEach((a,index)=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${index+1}</td><td>${a.name}</td><td>${a.mode}</td>
      <td><button class="action-btn" onclick="editAuth(${index})">Modifier</button>
      <button class="action-btn" onclick="deleteAuth(${index})">Supprimer</button></td>`;
    authTableBody.appendChild(row);
  });
}

function renderBotAuthList(){
  authListDiv.innerHTML='';
  authorizations.forEach(a=>{
    const btn=document.createElement('button');
    btn.textContent=a.name+(a.mode==='payant'?' üí∞':'');
    btn.style.display='block';btn.style.width='100%';btn.style.marginBottom='4px';btn.style.padding='6px';
    btn.style.borderRadius='6px';btn.style.border='none';btn.style.cursor='pointer';
    btn.style.background='#2563eb';btn.style.color='white';
    btn.onclick=()=>{ appendMsg('bot',`‚úÖ Informations: <b>${a.name}</b>`);};
    authListDiv.appendChild(btn);
  });
}

// --- Admin actions ---
addInstrBtn.onclick=()=>{ const text=prompt('Nouvelle instruction:'); if(text){instructions.push({text}); renderInstrTable();} }
addAuthBtn.onclick=()=>{ const name=prompt('Nom autorisation:'); if(!name) return; const mode=prompt('Mode (free/payant)','free'); authorizations.push({name,mode}); renderAuthTable(); renderBotAuthList();}
backHomeBtn.onclick=()=>{adminPanel.style.display='none';botBox.style.display='flex';}

// --- Bot float click ---
botFloat.onclick=()=>{botBox.style.display=botBox.style.display==='flex'?'none':'flex';}

// --- Admin login ---
adminBtn.onclick=()=>{ if(adminInput.value==='233233'){adminPanel.style.display='block';botBox.style.display='none';renderInstrTable();renderAuthTable();renderBotAuthList();}else alert('Code incorrect'); }

// --- Send message ---
sendBtn.onclick=()=>{ const text=inputText.value.trim(); if(!text) return; handleBotMessage(text); inputText.value=''; }

// --- Handle message ---
function handleBotMessage(userText){
  appendMsg('user',userText);
  const instr = instructions[Math.floor(Math.random()*instructions.length)];
  setTimeout(()=>{ appendMsg('bot',instr.text); saveConversation(userText,instr.text); },500);
}

// --- Conversation hibride ---
function saveConversation(user,bot){
  const timestamp=new Date().toISOString();
  conversations.push({user,bot,created_at:timestamp});
  localStorage.setItem('bot_conversations',JSON.stringify(conversations));
}
function loadConversations(){ conversations.forEach(c=>{appendMsg('user',c.user);appendMsg('bot',c.bot);}); }
function deleteOldMessages(){ const now=Date.now(); conversations=conversations.filter(m=>now-new Date(m.created_at).getTime()<7*24*60*60*1000); localStorage.setItem('bot_conversations',JSON.stringify(conversations)); }
loadConversations();
deleteOldMessages();
setInterval(deleteOldMessages,24*60*60*1000);

// --- Autorisations toggle ---
botFloat.addEventListener('contextmenu',e=>{ e.preventDefault(); authListDiv.style.display=authListDiv.style.display==='block'?'none':'block'; });

// --- Edit/Delete ---
window.editInstr=(i)=>{ const t=prompt('Modifier instruction:',instructions[i].text); if(t){instructions[i].text=t; renderInstrTable();} }
window.deleteInstr=(i)=>{ if(confirm('Supprimer ?')){instructions.splice(i,1); renderInstrTable();} }
window.editAuth=(i)=>{ const n=prompt('Modifier autorisation:',authorizations[i].name); if(!n) return; const m=prompt('Mode (free/payant)',authorizations[i].mode); authorizations[i].name=n; authorizations[i].mode=m; renderAuthTable(); renderBotAuthList();}
window.deleteAuth=(i)=>{ if(confirm('Supprimer ?')){authorizations.splice(i,1); renderAuthTable(); renderBotAuthList();} }

</script>
</body>
</html>